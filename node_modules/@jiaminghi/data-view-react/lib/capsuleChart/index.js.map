{"version":3,"file":"index.js","sources":["../../src/components/capsuleChart/index.js"],"sourcesContent":["import React, { useEffect, useState, useMemo } from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport classnames from 'classnames'\n\nimport { deepMerge } from '@jiaminghi/charts/lib/util/index'\n\nimport { deepClone } from '@jiaminghi/c-render/lib/plugin/util'\n\nimport './style.less'\n\nconst defaultConfig = {\n  /**\n   * @description Capsule chart data\n   * @type {Array<Object>}\n   * @default data = []\n   * @example data = [{ name: 'foo1', value: 100 }, { name: 'foo2', value: 100 }]\n   */\n  data: [],\n  /**\n   * @description Colors (hex|rgb|rgba|color keywords)\n   * @type {Array<String>}\n   * @default color = ['#37a2da', '#32c5e9', '#67e0e3', '#9fe6b8', '#ffdb5c', '#ff9f7f', '#fb7293']\n   * @example color = ['#000', 'rgb(0, 0, 0)', 'rgba(0, 0, 0, 1)', 'red']\n   */\n  colors: [\n    '#37a2da',\n    '#32c5e9',\n    '#67e0e3',\n    '#9fe6b8',\n    '#ffdb5c',\n    '#ff9f7f',\n    '#fb7293'\n  ],\n  /**\n   * @description Chart unit\n   * @type {String}\n   * @default unit = ''\n   */\n  unit: ''\n}\n\nconst CapsuleChart = ({ config = {}, className, style }) => {\n  const [{ mergedConfig, labelData, capsuleLength }, setState] = useState({\n    mergedConfig: null,\n    labelData: [],\n    capsuleLength: []\n  })\n\n  useEffect(() => {\n    const mergedConfig = deepMerge(deepClone(defaultConfig, true), config || {})\n\n    const { data } = mergedConfig\n\n    if (!data.length) return\n\n    const capsuleValue = data.map(({ value }) => value)\n\n    const maxValue = Math.max(...capsuleValue)\n\n    const oneFifth = maxValue / 5\n\n    setState({\n      mergedConfig,\n      capsuleLength: capsuleValue.map(v => (maxValue ? v / maxValue : 0)),\n      labelData: [...new Set(new Array(6).fill(0).map((v, i) => Math.ceil(i * oneFifth)))]\n    })\n  }, [config])\n\n  const classNames = useMemo(() => classnames('dv-capsule-chart', className), [\n    className\n  ])\n\n  return (\n    <div className={classNames} style={style}>\n      {!!mergedConfig && (\n        <React.Fragment>\n          <div className='label-column'>\n            {mergedConfig.data.map(({ name }) => (\n              <div key={name}>{name}</div>\n            ))}\n            <div>&nbsp;</div>\n          </div>\n\n          <div className='capsule-container'>\n            {capsuleLength.map((capsule, index) => (\n              <div className='capsule-item' key={index}>\n                <div\n                  style={{\n                    width: `${capsule * 100}%`,\n                    backgroundColor: `${\n                      mergedConfig.colors[index % mergedConfig.colors.length]\n                    }`\n                  }}\n                />\n              </div>\n            ))}\n            <div className='unit-label'>\n              {labelData.map((label, index) => (\n                <div key={label + index}>{label}</div>\n              ))}\n            </div>\n          </div>\n\n          {!!mergedConfig.unit && (\n            <div className='unit-text'>{mergedConfig.unit}</div>\n          )}\n        </React.Fragment>\n      )}\n    </div>\n  )\n}\n\nCapsuleChart.propTypes = {\n  config: PropTypes.object,\n  className: PropTypes.string,\n  style: PropTypes.object\n}\n\n// 指定 props 的默认值：\nCapsuleChart.defaultProps = {\n  config: {}\n}\n\nexport default CapsuleChart\n"],"names":["defaultConfig","data","colors","unit","CapsuleChart","config","className","style","useState","mergedConfig","labelData","capsuleLength","setState","useEffect","deepMerge","deepClone","length","capsuleValue","map","value","maxValue","Math","max","oneFifth","v","Set","Array","fill","i","ceil","classNames","useMemo","classnames","React","name","capsule","index","width","backgroundColor","label","propTypes","PropTypes","object","string","defaultProps"],"mappings":"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"}